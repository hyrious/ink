const D=({x:e,y:t},n=Math.hypot(e,t))=>({x:e/n,y:t/n}),S=(e,t)=>({x:e.x+t.x,y:e.y+t.y}),I=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),k=(e,t)=>({x:e.x*t,y:e.y*t}),E=({x:e,y:t})=>({x:t,y:-e}),O=({x:e,y:t})=>({x:-e,y:-t}),P=({x:e,y:t},n,r)=>{const i=Math.sin(r),s=Math.cos(r),p=e-n.x,o=t-n.y,c=p*s-o*i,g=p*i+o*s;return{x:c+n.x,y:g+n.y}},J=(e,t)=>e.x*t.x+e.y*t.y,V=(e,t,n)=>S(e,k(I(t,e),n)),L=(e,t,n)=>S(e,k(t,n));class w{constructor(t,n,r,i,s){this.p=t,this.r=n,this.v=r,this.d=i,this.l=s}toJSON(){return[this.p.x,this.p.y,this.r]}dup(t=this.r){return new w(this.p,t,this.v,this.d,this.l)}}class M{constructor(t,n=t.length>0?t[t.length-1].l:0){this.points=t,this.length=n,this.sections=[0],this.pending={__proto__:null},this.queue=[],this.updateSections()}get empty(){return this.points.length==0}get dot(){return this.points.length==1}insert(t,n){if(t==this.points.length)n.forEach(r=>this.push(r,!0)),t=this.points.length,(n=this.pending[t])?(delete this.pending[t],this.insert(t,n)):this.updateSections();else if(t>this.points.length)this.pending[t]&&console.warn(`Override pending points from ${t}`),this.pending[t]=n;else throw new RangeError(`Position ${t} conflicts with existing points`)}push(t,n=!1){let{points:r}=this;if(r.length>0){let i,s=r[r.length-1];i={x:(t.x+s.p.x)/2,y:(t.y+s.p.y)/2,r:t.r};let p=s.p,o=Math.hypot(i.x-p.x,i.y-p.y);if(this.updateLength(o),this.length-s.l<5)return;r.push(new w(i,i.r,D(I(p,i)),o,this.length)),n||this.updateSections()}else r.push(new w(t,t.r,{x:1,y:1},0,0))}outline(t,n){let r=this.sections.find(s=>t<s),i=this.points.slice(t>0?t-1:t,r);if(i.length>1){let s=[],p=[],o=i.length,c=n,g=i[0].r,f=!0;r==null&&i[o-1].d>.4*n&&(o-1>=0&&(i[o-1]=i[o-1].dup(Math.max(.1,i[o-1].r-.4))),o-2>=0&&(i[o-2]=i[o-2].dup(Math.max(.1,i[o-2].r-.2))),f=!1);for(let l=0;l<o;l++){let{p:a,r:$,v:x,d:y}=i[l];l==0&&(y=0,l<o-1&&(x=i[l+1].v));let Y=Math.min(1,y/n),B=Math.min(1,1-Y),R=Math.min(1,g+(B-g)*(Y*.3)),A=(l<o-1?i[l+1]:i[l]).v,v=l<o-1?J(x,A):1;c=Math.max(n*(.5*R),.75);let C=k(E(V(A,x,v)),c),Q=I(a,C);s.push(Q);let T=S(a,C);p.push(T),g=$}let F=[],X=[];for(let l=1/13,a=l;a<=1;a+=l)F.push(P(p[0],i[0].p,3.1416926535897933*a));if(f){let l=i[o-1],a=E(O(l.v)),$=L(l.p,a,c);for(let x=1/13,y=x;y<1;y+=x)X.push(P($,l.p,3.1416926535897933*y))}return s.concat(X,p.reverse(),F)}else if(i.length==1){let s=i[0],p=E(O(s.v)),o=L(s.p,p,n*.4125*s.r),c=[];for(let g=1/13,f=0;f<=2;f+=g)c.push(P(o,s.p,3.1416926535897933*f));return c}else return[]}updateLength(t){this.length+=t}updateSections(){let{sections:t}=this;for(let n=t.length>1?t[t.length-1]+1:1,r=this.points.length;n<r;n++)this.points[n].d<1e3&&J(this.points[n].v,this.points[n-1].v)<0&&(t.push(n),n+=1)}updateCurr(t,n){for(this.queue.push(t);this.queue.length>n;)this.queue.shift();let r=0,i=0;for(let s of this.queue)r+=s.x,i+=s.y;return n=this.queue.length,{x:r/n,y:i/n,r:t.r}}toJSON(){return this.points.map(t=>t.toJSON())}static fromJSON(t){if(!t||!Array.isArray(t))throw new RangeError("Invalid JSON representation for Stroke");return M.create(t.map(n=>({x:n[0],y:n[1],r:n[2]})))}static create(t=[]){let n=[],r=0;if(t.length>0){let i=t[0],s=0;n.push(new w(i,i.r,{x:1,y:1},0,0));for(let p=1;p<t.length;p++){let o=t[p],c=Math.hypot(o.x-i.x,o.y-i.y);s+=c,!(s-r<5)&&(n.push(new w(o,o.r,D(I(i,o)),c,s)),i=o,r=s)}}return new M(n,r)}}let G=document.getElementById("app"),h=document.createElementNS("http://www.w3.org/2000/svg","svg"),q=document.createElementNS("http://www.w3.org/2000/svg","g"),H={size:document.getElementById("stroke-size")};h.append(q);G.append(h);let d;q.setAttribute("fill","currentColor");h.setAttribute("fill-rule","nonzero");h.style.cssText="display: block; width: 100%; height: 100%; font-size: 0; touch-action: none; position: relative";let _=!1,u={__proto__:null},m={__proto__:null};h.onpointerdown=e=>{e.preventDefault(),e.stopPropagation(),h.setPointerCapture(e.pointerId),d=h.getBoundingClientRect();let t=M.create([{x:e.clientX-d.left,y:e.clientY-d.top,r:e.pressure}]),n=document.createElementNS("http://www.w3.org/2000/svg","path");n.style.pointerEvents="none",u[e.pointerId]=[t,n,e.clientX,e.clientY],m[e.pointerId]=!0,q.append(n),!_&&(_=!0,queueMicrotask(N))};h.onpointermove=e=>{if(e.preventDefault(),e.stopPropagation(),u[e.pointerId]){let[t,n,r,i]=u[e.pointerId];if(r==e.clientX&&i==e.clientY||(u[e.pointerId][2]=e.clientX,u[e.pointerId][3]=e.clientY,e.getCoalescedEvents?e.getCoalescedEvents().forEach(s=>{t.push({x:s.clientX-d.left,y:s.clientY-d.top,r:s.pressure})}):t.push({x:e.clientX-d.left,y:e.clientY-d.top,r:e.pressure}),m[e.pointerId]=!0,e.getPredictedEvents&&(u[e.pointerId][4]=e.getPredictedEvents()[0]),_))return;_=!0,queueMicrotask(N)}};h.onpointercancel=e=>{e.preventDefault(),e.stopPropagation(),u[e.pointerId]&&(u[e.pointerId][1].remove(),delete u[e.pointerId])};h.onpointerup=h.onpointerout=e=>{if(e.preventDefault(),e.stopPropagation(),u[e.pointerId]){let[t,n,r,i,s]=u[e.pointerId];s&&(s.clientX!=r||s.clientY!=i)?(t.push({x:Math.round(s.clientX-d.left),y:Math.round(s.clientY-d.top),r:s.pressure}),m[s.pointerId]=!0,N()):(t.dot||t.empty)&&n.remove(),console.log(t),delete u[e.pointerId]}};h.ontouchstart=h.ontouchmove=h.ontouchend=h.ontouchcancel=e=>{e.preventDefault(),e.stopPropagation()};const b=(e,t)=>({x:(e.x+t.x)/2,y:(e.y+t.y)/2}),K=({x:e,y:t})=>`M${e.toFixed(2)},${t.toFixed(2)}`,z=({x:e,y:t})=>`L${e.toFixed(2)},${t.toFixed(2)}`,U=(e,{x:t,y:n})=>`Q${e.x.toFixed(2)},${e.y.toFixed(2)} ${t.toFixed(2)},${n.toFixed(2)}`;function N(){_=!1;let e=H.size.valueAsNumber;for(let t in m)if(u[t]){let[n,r]=u[t],i="";for(let s of n.sections)i+=W(n.outline(s,e));r.setAttribute("d",i)}m={__proto__:null}}function W(e){if(e.length==0)return"";let t=e.shift(),n=K(t),r=1;for(let i of e)r&&(n+=z(b(t,i))),n+=U(t,b(t,i)),r=0,t=i;return n+z(e[e.length-1])}
//# sourceMappingURL=index-CKQqYgkG.js.map
