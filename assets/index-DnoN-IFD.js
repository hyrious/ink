(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();const b=({x:e,y:t},n=Math.hypot(e,t))=>({x:e/n,y:t/n}),S=(e,t)=>({x:e.x+t.x,y:e.y+t.y}),_=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),N=(e,t)=>({x:e.x*t,y:e.y*t}),$=({x:e,y:t})=>({x:t,y:-e}),C=({x:e,y:t})=>({x:-e,y:-t}),E=({x:e,y:t},n,s)=>{const i=Math.sin(s),r=Math.cos(s),l=e-n.x,o=t-n.y,c=l*r-o*i,f=l*i+o*r;return{x:c+n.x,y:f+n.y}},D=(e,t)=>e.x*t.x+e.y*t.y,T=(e,t,n)=>S(e,N(_(t,e),n)),J=(e,t,n)=>S(e,N(t,n));class m{constructor(t,n,s,i,r){this.p=t,this.r=n,this.v=s,this.d=i,this.l=r}toJSON(){return[this.p.x,this.p.y,this.r]}dup(t=this.r){return new m(this.p,t,this.v,this.d,this.l)}}class M{constructor(t,n=t.length>0?t[t.length-1].l:0){this.points=t,this.length=n,this.sections=[0],this.pending={__proto__:null},this.queue=[],this.updateSections()}get empty(){return this.points.length==0}get dot(){return this.points.length==1}insert(t,n){if(t==this.points.length)n.forEach(s=>this.push(s,!0)),t=this.points.length,(n=this.pending[t])?(delete this.pending[t],this.insert(t,n)):this.updateSections();else if(t>this.points.length)this.pending[t]&&console.warn(`Override pending points from ${t}`),this.pending[t]=n;else throw new RangeError(`Position ${t} conflicts with existing points`)}push(t,n=!1){let{points:s}=this;if(s.length>0){let i,r=s[s.length-1];i={x:(t.x+r.p.x)/2,y:(t.y+r.p.y)/2,r:t.r};let l=r.p,o=Math.hypot(i.x-l.x,i.y-l.y);if(this.updateLength(o),this.length-r.l<5)return;s.push(new m(i,i.r,b(_(l,i)),o,this.length)),n||this.updateSections()}else s.push(new m(t,t.r,{x:1,y:1},0,0))}outline(t,n){let s=this.sections.find(r=>t<r),i=this.points.slice(t>0?t-1:t,s);if(i.length>1){let r=[],l=[],o=i.length,c=n,f=i[0].r,g=!0;s==null&&i[o-1].d>.4*n&&(o-1>=0&&(i[o-1]=i[o-1].dup(Math.max(.1,i[o-1].r-.4))),o-2>=0&&(i[o-2]=i[o-2].dup(Math.max(.1,i[o-2].r-.2))),g=!1);for(let p=0;p<o;p++){let{p:a,r:P,v:y,d:x}=i[p];p==0&&(x=0,p<o-1&&(y=i[p+1].v));let X=Math.min(1,x/n),z=Math.min(1,1-X),B=Math.min(1,f+(z-f)*(X*.3)),Y=(p<o-1?i[p+1]:i[p]).v,R=p<o-1?D(y,Y):1;c=Math.max(n*(.5*B),.75);let A=N($(T(Y,y,R)),c),Q=_(a,A);r.push(Q);let K=S(a,A);l.push(K),f=P}let F=[],L=[];for(let p=1/13,a=p;a<=1;a+=p)F.push(E(l[0],i[0].p,3.1416926535897933*a));if(g){let p=i[o-1],a=$(C(p.v)),P=J(p.p,a,c);for(let y=1/13,x=y;x<1;x+=y)L.push(E(P,p.p,3.1416926535897933*x))}return r.concat(L,l.reverse(),F)}else if(i.length==1){let r=i[0],l=$(C(r.v)),o=J(r.p,l,n*.4125*r.r),c=[];for(let f=1/13,g=0;g<=2;g+=f)c.push(E(o,r.p,3.1416926535897933*g));return c}else return[]}updateLength(t){this.length+=t}updateSections(){let{sections:t}=this;for(let n=t.length>1?t[t.length-1]+1:1,s=this.points.length;n<s;n++)this.points[n].d<1e3&&D(this.points[n].v,this.points[n-1].v)<0&&(t.push(n),n+=1)}updateCurr(t,n){for(this.queue.push(t);this.queue.length>n;)this.queue.shift();let s=0,i=0;for(let r of this.queue)s+=r.x,i+=r.y;return n=this.queue.length,{x:s/n,y:i/n,r:t.r}}toJSON(){return this.points.map(t=>t.toJSON())}static fromJSON(t){if(!t||!Array.isArray(t))throw new RangeError("Invalid JSON representation for Stroke");return M.create(t.map(n=>({x:n[0],y:n[1],r:n[2]})))}static create(t=[]){let n=[],s=0;if(t.length>0){let i=t[0],r=0;n.push(new m(i,i.r,{x:1,y:1},0,0));for(let l=1;l<t.length;l++){let o=t[l],c=Math.hypot(o.x-i.x,o.y-i.y);r+=c,!(r-s<5)&&(n.push(new m(o,o.r,b(_(i,o)),c,r)),i=o,s=r)}}return new M(n,s)}}let V=document.getElementById("app"),u=document.createElementNS("http://www.w3.org/2000/svg","svg"),O=document.createElementNS("http://www.w3.org/2000/svg","g"),G={size:document.getElementById("stroke-size")};u.append(O);V.append(u);let d;O.setAttribute("fill","currentColor");u.setAttribute("fill-rule","nonzero");u.style.cssText="display: block; width: 100%; height: 100%; font-size: 0; touch-action: none; position: relative";let w=!1,h={__proto__:null},I={__proto__:null};u.onpointerdown=e=>{e.preventDefault(),e.stopPropagation(),u.setPointerCapture(e.pointerId),d=u.getBoundingClientRect();let t=M.create([{x:e.clientX-d.left,y:e.clientY-d.top,r:e.pressure}]),n=document.createElementNS("http://www.w3.org/2000/svg","path");n.style.pointerEvents="none",h[e.pointerId]=[t,n,e.clientX,e.clientY],I[e.pointerId]=!0,O.append(n),!w&&(w=!0,queueMicrotask(q))};u.onpointermove=e=>{if(e.preventDefault(),e.stopPropagation(),h[e.pointerId]){let[t,n,s,i]=h[e.pointerId];if(s==e.clientX&&i==e.clientY||(h[e.pointerId][2]=e.clientX,h[e.pointerId][3]=e.clientY,e.getCoalescedEvents?e.getCoalescedEvents().forEach(r=>{t.push({x:r.clientX-d.left,y:r.clientY-d.top,r:r.pressure})}):t.push({x:e.clientX-d.left,y:e.clientY-d.top,r:e.pressure}),I[e.pointerId]=!0,e.getPredictedEvents&&(h[e.pointerId][4]=e.getPredictedEvents()[0]),w))return;w=!0,queueMicrotask(q)}};u.onpointercancel=e=>{e.preventDefault(),e.stopPropagation(),h[e.pointerId]&&(h[e.pointerId][1].remove(),delete h[e.pointerId])};u.onpointerup=u.onpointerout=e=>{if(e.preventDefault(),e.stopPropagation(),h[e.pointerId]){let[t,n,s,i,r]=h[e.pointerId];r&&(r.clientX!=s||r.clientY!=i)?(t.push({x:Math.round(r.clientX-d.left),y:Math.round(r.clientY-d.top),r:r.pressure}),I[r.pointerId]=!0,q()):(t.dot||t.empty)&&n.remove(),console.log(t),delete h[e.pointerId]}};u.ontouchstart=u.ontouchmove=u.ontouchend=u.ontouchcancel=e=>{e.preventDefault(),e.stopPropagation()};const k=(e,t)=>({x:(e.x+t.x)/2,y:(e.y+t.y)/2}),H=({x:e,y:t})=>`M${e.toFixed(2)},${t.toFixed(2)}`,v=({x:e,y:t})=>`L${e.toFixed(2)},${t.toFixed(2)}`,U=(e,{x:t,y:n})=>`Q${e.x.toFixed(2)},${e.y.toFixed(2)} ${t.toFixed(2)},${n.toFixed(2)}`;function q(){w=!1;let e=G.size.valueAsNumber;for(let t in I)if(h[t]){let[n,s]=h[t],i="";for(let r of n.sections)i+=W(n.outline(r,e));s.setAttribute("d",i)}I={__proto__:null}}function W(e){if(e.length==0)return"";let t=e.shift(),n=H(t),s=1;for(let i of e)s&&(n+=v(k(t,i))),n+=U(t,k(t,i)),s=0,t=i;return n+v(e[e.length-1])}
